!function(){var N="_sotmpid",j=63072e3,M="_sotmsid",O=1800,W=!1,z=1,U="",X="play";(function(v){"use strict";var m=v.navigator,e=v.console,n=function(e,n){return e.bind?e.bind(n):e},h=W&&e?n(e.log,e):function(){},f=W&&e?n(e.info,e):function(){},g=W&&e?n(e.warn,e):function(){},i=W&&e?n(e.error,e):function(){},t=function(){return document.body||document.getElementsByTagName("body").item(0)},y=(h("Initializing Tentacles ingestion module"),v.screen.availWidth),w=v.screen.availHeight,b=function(){return v["innerWidth"]||document.documentElement["clientWidth"]||t()["clientWidth"]||document.documentElement["offsetWidth"]||t()["offsetWidth"]},k=function(){return v["innerHeight"]||document.documentElement["clientHeight"]||t()["clientHeight"]||document.documentElement["offsetHeight"]||t()["offsetHeight"]},p,I,P,x,T,d="https://ingestion.smartocto.com",C=function(){var u=[0,10,20,5,15,16,1,11,21,6,7,17,2,12,22,23,8,18,3,13,14,24,9,19,4],f=[1,32898,32906,2147516416,32907,2147483649,2147516545,32777,138,136,2147516425,2147483658,2147516555,139,32905,32771,32770,128,32778,2147483658,2147516545,32896],g=[0,1,30,28,27,4,12,6,23,20,3,10,11,25,7,9,13,15,21,8,18,2,29,24,14],p=function(e,n){return e<<n|e>>>32-n};return function(e){var n,i=[];for(n=0;n<25;n+=1)i[n]=0;if(e.length%16===15)e+="老";else{e+="";while(e.length%16!==15)e+="\0";e+="耀"}for(var t=0;t<e.length;t+=16){for(n=0;n<16;n+=2)i[n/2]^=e.charCodeAt(t+n)+e.charCodeAt(t+n+1)*65536;for(var o=0;o<22;o+=1){var r=[];for(n=0;n<5;n+=1)r[n]=i[n]^i[n+5]^i[n+10]^i[n+15]^i[n+20];var a=[];for(n=0;n<5;n+=1)a[n]=r[(n+4)%5]^p(r[(n+1)%5],1);var d=[];for(n=0;n<25;n+=1)d[u[n]]=p(i[n]^a[n%5],g[n]);for(n=0;n<5;n+=1)for(var s=0;s<25;s+=5)i[s+n]=d[s+n]^~d[s+(n+1)%5]&d[s+(n+2)%5];i[0]^=f[o]}}var l=[];for(n=0;n<8;++n){var c=i[n];l.push(c&255,c>>>8,c>>>16,c>>>24)}return l}}(),o=function(e){return document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+e+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")||null},E=function(e,n,i,t,o){var r=new Date(t+1e3*i);var a=e+"="+n+"; path=/; expires="+r.toUTCString()+"; max-age="+i;if(o)a+="; domain="+o;document.cookie=a},r=function(){var t=Math,i=v["crypto"]||v["msCrypto"],o="undefined"!==typeof i&&"undefined"!==typeof i["getRandomValues"],r=o?function(e){var n=new Uint8Array(e);i["getRandomValues"](n);return n}:function(e){var n=new Array(e);for(var i=0;i<e;++i)n[i]=t.floor(t.random()*256);return n},n=function(e){var n=r(e),i="";for(var t=0;t<n.length;++t)i+=String.fromCharCode(n[t]);return i},a=["application/pdf","video/quicktime","video/x-msvideo","audio/x-pn-realaudio-plugin","audio/mpeg3","application/googletalk","application/x-mplayer2","application/x-director","application/x-shockwave-flash","application/x-java-vm","application/x-googlegears","application/x-silverlight"],d=function(){var e,n=m["mimeTypes"];h(m["mimeTypes"]);if(n){e="plugins:";for(var i=0,t=a.length;i<t;++i){var o=a[i];e+=o in n?"1":"0"}}else e="";return e},s=["ShockwaveFlash.ShockwaveFlash.1","AcroPDF.PDF","AgControl.AgControl","QuickTime.QuickTime"],l=function(){var n;if("ActiveXObject"in v){n="activex:";for(var e=0,i=s.length;e<i;++e){var t=s[e];try{var o=new ActiveXObject(t);n+="1";if("getVersions"in o)n+="("+o["getVersions"]()+")";else if("getVariable"in o)n+="("+o["getVariable"]("$version")+")"}catch(e){n+="0"}}}else n="";return n},c=function(){var e=b(),n=k();return[m["userAgent"]||"",m["platform"]||"",m["language"]||"",m["systemLanguage"]||"",m["userLanguage"]||"",y?y.toString(36):"",w?w.toString(36):"",e?e.toString(36):"",n?e.toString(36):"",d(),l()]},u=function(){var e=[(new Date).getTime().toString(36),v.location.href||"",n(32)];if(!o)e.push.apply(e,c());return C(e.join(""))},f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxzy0123456789~_",g=function(){var e=u();var n="";for(var i=0,t=e.length;i<t;++i)n+=f.charAt(e[i]&63);if(!o)n+="!";return n};var p=(new Date).getTime();return function(e){var n=g();return"0:"+(e?p.toString(36)+":"+n:n)}}(),s=function(e,n){var i=false;var t=setTimeout(function(){if(!i){i=true;h("Timeout waiting for event callback; invoking anyway.",this,arguments);e.apply(this,arguments)}},n);return function(){if(!i){i=true;clearTimeout(t);e.apply(this,arguments)}}},S=function(e,n){var i;var t={};switch(e.toLowerCase()){case"pageview":i="/t";t=!n?{}:{ch:n["channel"]};break;case"linkclick":case"loyaltyclick":i="/c";t=!n?{}:{htcid:n["headerTestChosenId"],htid:n["headerTestId"],bid:n["brandId"],lh:n["linkHeight"],lp:n["linkPath"],lps:n["linkPosition"],lcp:n["linkSourcePath"],lw:n["linkWidth"],lx1:n["linkX1"],lx2:n["linkX2"],ly1:n["linkY1"],ly2:n["linkY2"],lxp:n["linkXPath"],rid:n["relationId"]};break;case"impressions":i="/i";t=!n?{}:{bid:n["brandId"],impressions:n["impressions"]};break;case"readingtime":i="/r";t=!n?{}:{ar:n["ar"],at:n["at"],bid:n["brandId"],rid:n["relationId"],wc:n["wc"],sp:n["sp"]};break;case"datalayer":i="/d";t=!n?{}:{bid:n["brandId"],rid:n["relationId"],au:n["author"],at:n["articleType"],aa:n["articleAccess"],se:n["section"],le:n["length"],re:n["region"],uri:n["uri"],ti:n["title"],ta:n["tags"],ts:n["timestamp"],vid:n["videoId"],va:n["videoAuthor"],vt:n["videoTitle"],vpd:n["videoPublicationDate"],ha:n["hash"],hv:n["hasVideo"],do:n["documentId"],ch:n["channel"]};break;case"videoplay":i="/v";t=!n?{}:{bid:n["brandId"],vid:n["videoId"],vt:n["title"],rid:n["relationId"],ac:X,se:n["section"],ta:n["tags"],ch:n["channel"],uri:n["uri"],vd:n["duration"],iu:n["imageUrl"],va:n["authors"],vpd:n["pubDate"]};break}return{endpoint:i,mapping:t}},a=function(){this.queue=[]},A=(a.prototype.enqueue=function(e){var n=this.queue;h("Queueing item for processing; "+n.length+" currently pending.",e);n.push(e);if(1===n.length){h("No pending items; processing immediately.",e);this.processNextItem()}},a.prototype.processNextItem=function(){var e=this.queue[0];switch(typeof e){case"string":this.deliverFirstPendingEvent(e);break;case"function":this.invokeFirstPendingCallback(e);break;default:i("Dropping unknown type of item in beacon queue.",e);this.onFirstPendingItemCompleted()}},a.prototype.deliverFirstPendingEvent=function(e){var n=this;h("Delivering pending event.",e);var i=e.split("&").reduce(function(e,n,i,t){var o=n.split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1]);return e},{});var t=s(function(){n.onFirstPendingItemCompleted()},z*1e3);var o=new XMLHttpRequest;o.onload=t;o.onerror=!W?t:function(e){g("Error delivering event",a);t()};var r=S(i["t"]).endpoint;var a=d+r+"?"+e;o.open("get",a,true);o.send()},a.prototype.invokeFirstPendingCallback=function(e){e();this.onFirstPendingItemCompleted()},a.prototype.onFirstPendingItemCompleted=function(){h("Marking pending item as complete.");var e=this.queue;e.shift();var n=e.length;if(0<n){h("Processing next item; remaining count:",n);this.processNextItem()}else h("All pending items have been delivered.")},new a),l=o(N),c=o(M);if(x=!l){h("New party; generating identifier.");p=r(true)}else p=l;if(T=!c){h("New session; generating identifier.");I=r(true)}else I=c;f("Tentacles ingestion party/session identifiers",p,I);var u=0,H=function(){var e=u++;return P+e.toString(16)},F=function(){P=r(false);L["pageViewId"]=P;u=0;f("Starting page view",P)},V,L={partyId:p,sessionId:I,pageViewId:P,isNewPartyId:x,isFirstInSession:T,active:false,signal:function(e,n){if(!P)F();var i;if(e){i=H();if("undefined"===typeof n)f("Signalling event: "+e,i);else f("Signalling event with params: "+e,i,n);var t=document.referrer,o=(new Date).getTime(),r={p:p,s:I,v:P,e:i,c:o,n:x?"t":"f",f:T?"t":"f",l:v.location.href,r:t?t:undefined,i:y,j:w,k:v["devicePixelRatio"],w:b(),h:k(),t:e};var a=S(e,n).mapping;Object.assign(r,a);var d="",s={},l=function(e,n){if(d.length>0)d+="&";var i=s[e];if("undefined"===typeof i){i=[];s[e]=i}i.push(n);d+=e+"="+encodeURIComponent(n)};for(var c in r)if(r.hasOwnProperty(c)){var u=r[c];switch(typeof u){case"undefined":break;case"number":l(c,u);break;default:l(c,u)}}x=false;T=false;E(M,I,O,o,U);E(N,p,j,o,U);A.enqueue(d)}else{g("Ignoring event with no type.");i=null}return i},apiToken:v.hasOwnProperty("tentacles")&&v["tentacles"].hasOwnProperty("apiToken")?v["tentacles"]["apiToken"]:null},D,q;if("object"!==typeof v["ingestion"]||!v["ingestion"].hasOwnProperty("partyId")){if(typeof v["define"]==="function"&&v["define"]["amd"])v["ingestion"]=L;else if(typeof v["module"]!=="undefined"&&v["module"]["exports"])v["module"]["exports"]=L;else v["ingestion"]=L;h("Module initialized.",L);if(typeof document["hidden"]!=="undefined"){D="hidden";q="visibilitychange"}else if(typeof document["mozHidden"]!=="undefined"){D="mozHidden";q="mozvisibilitychange"}else if(typeof document["msHidden"]!=="undefined"){D="msHidden";q="msvisibilitychange"}else if(typeof document["webkitHidden"]!=="undefined"){D="webkitHidden";q="webkitvisibilitychange"}else g("Could not detect property for document visibility.");if(!v.document[D]){h("Page already visible; starting page view immediately.");F()}else if(v.document["addEventListener"]&&v.document["removeEventListener"]){h("Page currently hidden; deferring start of page view.");v.document["addEventListener"](q,function e(){if(null===P&&v.document[D]===false){h("Page became visible; starting deferred page view.");F()}if(null!==P)v.document["removeEventListener"](q,e)})}else{g("Page currently hidden, but don't know how to defer start of page view; starting page view immediately.");F()}if("onpageshow"in v&&"onpagehide"in v&&v["addEventListener"]&&v["removeEventListener"]){h("Detected Page Transition Event API; will trigger additional page-views during navigation.");v["addEventListener"]("pagehide",function e(){v["removeEventListener"]("pagehide",e);v["addEventListener"]("pageshow",function(){h("Returning to page that is still loaded; starting a new page-view.");F()})})}else{var R=v["history"];if(R&&typeof(R["navigationMode"]!=="undefined")){f("Changing navigation mode from "+R["navigationMode"]+" to 'compatible'.");R["navigationMode"]="compatible"}}}else g("Ingestion module already initialized; existing module left intact.")})("undefined"!=typeof window?window:this)}("undefined"==typeof t&&(t={}));